<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0 user-scalable=no">
    <title>Read Distance</title>

    <link rel="icon" type="image/svg+xml" href="../images/favicon.svg">
    <link rel="stylesheet" type="text/css" href="../css/marker-style.css">
</head>
<body>
    <!-- Top Bar -->
    <div id="top-bar">
        <div class="text" id="text-result">Ready ...</div>
        <button class="left" onclick="btnReset()">Reset</button>
        <button class="red" onclick="btnClose()">Close</button>
    </div>

    <!-- Scanner -->
    <div class="scanner" id="scanner1"></div>
    <div class="scanner" id="scanner2"></div>


    <script src="../js/MultitouchMarker-2.1.js"></script>
    
    <script>

        /////////////////////////////////////////////////////////////////////
        //                     Scanner Initialization                      //
        /////////////////////////////////////////////////////////////////////

        // Scanner 1
        const scanner1 = new Scanner({
            element: "scanner1",
            posX: "10vw",
            posY: "30vh",
            width: "38vw",
            height: "38vw",
            rotate: "5deg",
            bgColor: "#f5720055",
            bgImage: "url(../images/bgScanner.png)",
            bgActive: "url(../images/bgActive.png)",
            text: "Place Multitouch Marker here!",
            showResult: true,
            showDot: true,
            dotColor: "#4771ed",
        });

        // Scanner 2
        const scanner2 = new Scanner({
            element: "scanner2",
            posX: "58vw",
            posY: "30vh",
            // width: "38vw",
            // height: "38vw",
            // rotate: "5deg",
            // bgColor: "#f5720055",
            // bgImage: "url(../images/bgScanner.png)",
            // bgActive: "url(../images/bgActive.png)",
            // text: "Place Multitouch Marker here!",
            // showResult: true,
            // showDot: true,
            // dotColor: "#4771ed",
        });


        /////////////////////////////////////////////////////////////////////
        //                        Read Every Frame                         //
        /////////////////////////////////////////////////////////////////////
        
        const textResult = document.getElementById("text-result");
        let scanResult = {};
        let text1 = "Scanner 1 ready...";
        let text2 = "Scanner 2 ready...";

        function frameLoop() {
            if (scanner1.getData(scanResult)) {
                text1 = `Scanner 1: ${scanResult.distance} px (${scanResult.numOfTouch} touches)`;
            }
            else if (scanner2.getData(scanResult)) {
                text2 = `Scanner 2: ${scanResult.distance} px (${scanResult.numOfTouch} touches)`;
            }

            textResult.textContent = text1 + " || " + text2;

            requestAnimationFrame(() => {
                frameLoop();
            });
        }

        frameLoop();


        /////////////////////////////////////////////////////////////////////
        //                        Button Functions                         //
        /////////////////////////////////////////////////////////////////////

        function btnReset() {
            window.location.reload();
        }

        function btnClose() {
            window.location.href = "../index.html";
        }

    </script>
</body>
</html>